<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>भर्चुअल किबोर्ड</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }

        body {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background: #1c1c1c;
        }

        .container {
            width: 95%;
            max-width: 1000px;
            margin: 0 auto;
        }

        .keyboard {
            position: relative;
            background: #333;
            padding: 2vw;
            border-radius: 10px;
            box-shadow: 0 0 20px rgba(0,0,0,0.5);
            width: 100%;
        }

        .keyboard .row {
            display: flex;
            justify-content: center;
            margin: 0.4vw 0;
        }

        .keyboard .key {
            width: 4vw;
            height: 4vw;
            min-width: 30px;
            min-height: 30px;
            max-width: 60px;
            max-height: 60px;
            background: #222;
            color: #fff;
            border: none;
            border-radius: 5px;
            margin: 0 0.3vw;
            cursor: pointer;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: clamp(12px, 1.2vw, 18px);
            font-family: Arial, sans-serif;
            transition: all 0.2s;
            user-select: none;
        }

        .keyboard .key:hover {
            background: #444;
        }

        .keyboard .key:active {
            background: #666;
            transform: scale(0.95);
        }

        .keyboard .key.special {
            width: 6.5vw;
            max-width: 100px;
        }

        .keyboard .key.space {
            width: 26vw;
            max-width: 400px;
        }

        .keyboard .key.shift {
            width: 8vw;
            max-width: 120px;
        }

        .keyboard .key.enter {
            width: 8vw;
            max-width: 120px;
        }

        .keyboard .key.backspace {
            width: 8vw;
            max-width: 120px;
        }

        .keyboard .key.tab {
            width: 6vw;
            max-width: 90px;
        }

        .keyboard .key.caps {
            width: 7.3vw;
            max-width: 110px;
            font-size: clamp(11px, 1.1vw, 16px);
        }

        .output {
            width: 100%;
            height: 150px;
            background: #fff;
            margin: 20px auto;
            padding: 10px;
            border-radius: 5px;
            font-size: clamp(14px, 1.2vw, 18px);
            resize: none;
            -webkit-user-select: text;
            -moz-user-select: text;
            -ms-user-select: text;
            user-select: text;
        }

        .keyboard .key.active-indicator {
            background: #222;
            color: #fff;
        }

        .keyboard .key.caps, .keyboard .key.shift {
            position: relative;
        }

        .keyboard .key.caps::before, .keyboard .key.shift::before {
            content: '';
            position: absolute;
            top: 5px;
            right: 5px;
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #333;
            transition: all 0.2s;
        }

        .keyboard .key.caps.active-indicator::before, .keyboard .key.shift.active-indicator::before {
            background: #2ecc71;
            box-shadow: 0 0 5px #2ecc71;
        }

        .keyboard .key.backspace span.text {
            display: inline;
        }

        .keyboard .key.backspace span.icon {
            display: none;
        }

        /* Backspace icon style */
        .keyboard .key.backspace span.icon::before {
            content: '←';
            font-size: 1.2em;
            font-weight: bold;
        }

        .keyboard .key.caps span.text {
            display: inline;
        }

        .keyboard .key.caps span.icon {
            display: none;
        }

        /* Caps Lock icon style */
        .keyboard .key.caps span.icon::before {
            content: '⇪';
            font-size: 1.2em;
            font-weight: bold;
        }

        .keyboard .key.shift span.text {
            display: inline;
        }

        .keyboard .key.shift span.icon {
            display: none;
        }

        /* Shift icon style */
        .keyboard .key.shift span.icon::before {
            content: '⬆';
            font-size: 1.4em;
            font-weight: bold;
            transform: scale(1.2, 0.9);
            display: inline-block;
        }

        /* Screen size breakpoints for better text scaling */
        @media screen and (max-width: 1200px) {
            .keyboard .key {
                font-size: clamp(10px, 1.8vw, 16px);
            }

            .keyboard .key.backspace,
            .keyboard .key.tab,
            .keyboard .key.caps,
            .keyboard .key.enter,
            .keyboard .key.shift {
                font-size: clamp(9px, 1.6vw, 14px);
            }

            .keyboard .key.caps {
                font-size: clamp(9px, 1.4vw, 14px);
            }
        }

        @media screen and (max-width: 992px) {
            .keyboard .key {
                font-size: clamp(9px, 2vw, 14px);
            }

            .keyboard .key.backspace,
            .keyboard .key.tab,
            .keyboard .key.caps,
            .keyboard .key.enter,
            .keyboard .key.shift {
                font-size: clamp(8px, 1.8vw, 13px);
            }

            .keyboard .key.caps {
                font-size: clamp(8px, 1.6vw, 12px);
            }
        }

        @media screen and (max-width: 768px) {
            .keyboard .key {
                font-size: clamp(8px, 2.2vw, 13px);
                min-width: 25px;
                min-height: 25px;
            }

            .keyboard .key.backspace,
            .keyboard .key.tab,
            .keyboard .key.caps,
            .keyboard .key.enter,
            .keyboard .key.shift {
                font-size: clamp(7px, 2vw, 12px);
            }

            .container {
                width: 98%;
            }

            .keyboard {
                padding: 1.5vw;
            }

            .keyboard .row {
                margin: 0.3vw 0;
            }

            .output {
                height: 100px;
                font-size: clamp(12px, 2.5vw, 16px);
            }

            .keyboard .key.backspace span.text {
                display: none;
            }

            .keyboard .key.backspace span.icon {
                display: inline;
            }

            .keyboard .key.caps span.text {
                display: none;
            }

            .keyboard .key.caps span.icon {
                display: inline;
            }

            .keyboard .key.shift span.text {
                display: none;
            }

            .keyboard .key.shift span.icon {
                display: inline;
            }
        }

        @media screen and (max-width: 576px) {
            .keyboard .key {
                font-size: clamp(7px, 2.5vw, 12px);
                min-width: 22px;
                min-height: 22px;
            }

            .keyboard .key.backspace,
            .keyboard .key.tab,
            .keyboard .key.caps,
            .keyboard .key.enter,
            .keyboard .key.shift {
                font-size: clamp(6px, 2.2vw, 11px);
            }

            .keyboard {
                padding: 1.2vw;
            }

            .keyboard .row {
                margin: 0.25vw 0;
            }

            .output {
                height: 90px;
                font-size: clamp(11px, 2.8vw, 14px);
            }

            .keyboard .key.caps span.icon {
                font-size: clamp(6px, 2vw, 10px);
                width: 8.5vw;
            }
        }

        @media screen and (max-width: 480px) {
            .keyboard .key {
                font-size: clamp(6px, 2.8vw, 11px);
                min-width: 20px;
                min-height: 20px;
            }

            .keyboard .key.backspace,
            .keyboard .key.tab,
            .keyboard .key.caps,
            .keyboard .key.enter,
            .keyboard .key.shift {
                font-size: clamp(5px, 2.2vw, 10px);
            }

            .keyboard {
                padding: 1vw;
            }

            .keyboard .row {
                margin: 0.2vw 0;
            }

            .output {
                height: 80px;
                margin: 10px auto;
                font-size: clamp(10px, 3vw, 13px);
            }

            .keyboard .key.backspace span.icon::before {
                font-size: 1.5em;
            }

            .keyboard .key.caps span.icon::before {
                font-size: 1.5em;
            }

            .keyboard .key.shift span.icon::before {
                font-size: 1.6em;
                transform: scale(1.3, 0.9);
            }
        }

        @media screen and (max-width: 360px) {
            .keyboard .key {
                font-size: clamp(5px, 3vw, 10px);
                min-width: 18px;
                min-height: 18px;
            }

            .keyboard .key.backspace,
            .keyboard .key.tab,
            .keyboard .key.caps,
            .keyboard .key.enter,
            .keyboard .key.shift {
                font-size: clamp(4px, 2.5vw, 9px);
            }

            .output {
                height: 70px;
                font-size: clamp(9px, 3.2vw, 12px);
            }

            .keyboard .key.caps span.icon::before {
                font-size: 1.5em;
            }

            .keyboard .key.shift span.icon::before {
                font-size: 1.7em;
                transform: scale(1.4, 0.9);
            }
        }

        .keyboard-info {
            background: #2a2a2a;
            color: #fff;
            padding: 8px 15px;
            border-radius: 0 0 10px 10px;
            margin-top: 5px;
            font-family: Arial, sans-serif;
            display: flex;
            justify-content: flex-start;
            align-items: center;
        }

        .keyboard-info .window-size {
            font-size: 0.9em;
            opacity: 0.8;
            letter-spacing: 0.5px;
            padding-left: 5px;
        }

        @media screen and (max-width: 768px) {
            .keyboard-info {
                padding: 6px 12px;
                font-size: 0.85em;
            }
        }

        @media screen and (max-width: 480px) {
            .keyboard-info {
                padding: 5px 10px;
                font-size: 0.8em;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <textarea class="output" placeholder="यहाँ टाइप गर्नुहोस्..."></textarea>
        <div class="keyboard">
            <div class="row">
                <button class="key">`</button>
                <button class="key">1</button>
                <button class="key">2</button>
                <button class="key">3</button>
                <button class="key">4</button>
                <button class="key">5</button>
                <button class="key">6</button>
                <button class="key">7</button>
                <button class="key">8</button>
                <button class="key">9</button>
                <button class="key">0</button>
                <button class="key">-</button>
                <button class="key">=</button>
                <button class="key backspace"><span class="text">Backspace</span><span class="icon"></span></button>
            </div>
            <div class="row">
                <button class="key tab">Tab</button>
                <button class="key">Q</button>
                <button class="key">W</button>
                <button class="key">E</button>
                <button class="key">R</button>
                <button class="key">T</button>
                <button class="key">Y</button>
                <button class="key">U</button>
                <button class="key">I</button>
                <button class="key">O</button>
                <button class="key">P</button>
                <button class="key">[</button>
                <button class="key">]</button>
                <button class="key">\</button>
            </div>
            <div class="row">
                <button class="key caps"><span class="text">Caps Lock</span><span class="icon"></span></button>
                <button class="key">A</button>
                <button class="key">S</button>
                <button class="key">D</button>
                <button class="key">F</button>
                <button class="key">G</button>
                <button class="key">H</button>
                <button class="key">J</button>
                <button class="key">K</button>
                <button class="key">L</button>
                <button class="key">;</button>
                <button class="key">'</button>
                <button class="key enter">Enter</button>
            </div>
            <div class="row">
                <button class="key shift"><span class="text">Shift</span><span class="icon"></span></button>
                <button class="key">Z</button>
                <button class="key">X</button>
                <button class="key">C</button>
                <button class="key">V</button>
                <button class="key">B</button>
                <button class="key">N</button>
                <button class="key">M</button>
                <button class="key">,</button>
                <button class="key">.</button>
                <button class="key">/</button>
                <button class="key shift"><span class="text">Shift</span><span class="icon"></span></button>
            </div>
            <div class="row">
                <button class="key">Ctrl</button>
                <button class="key">Win</button>
                <button class="key">Alt</button>
                <button class="key space">Space</button>
                <button class="key">Alt</button>
                <button class="key">Fn</button>
                <button class="key">Ctrl</button>
            </div>
        </div>
        <div class="keyboard-info">
            <div class="window-size">Window Size: <span id="window-width">0</span> x <span id="window-height">0</span></div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const output = document.querySelector('.output');
            const keyboard = document.querySelector('.keyboard');
            let capsLock = false;
            let shift = false;
            let shiftLock = false;
            let backspaceInterval = null;
            let backspaceTimeout = null;
            let lastShiftClick = 0;

            // अटोमेटिक फोकस टाइप बक्समा
            output.focus();

            // शिफ्ट क्लिक ह्यान्डलर
            function handleShiftClick(target) {
                const currentTime = new Date().getTime();
                const timeDiff = currentTime - lastShiftClick;

                if (timeDiff < 300) { // डबल क्लिक भएको छ (300ms भित्र)
                    shiftLock = !shiftLock;
                    shift = shiftLock;
                } else { // सिंगल क्लिक
                    if (!shiftLock) {
                        shift = !shift;
                    }
                }

                // इन्डिकेटर अपडेट
                document.querySelectorAll('.key.shift').forEach(shiftKey => {
                    if (shiftLock || shift) {
                        shiftKey.classList.add('active-indicator');
                    } else {
                        shiftKey.classList.remove('active-indicator');
                    }
                });

                lastShiftClick = currentTime;
            }

            // ब्याकस्पेस लङ्ग प्रेस
            keyboard.addEventListener('mousedown', (e) => {
                const keyElement = e.target.closest('.key');
                if (keyElement && keyElement.classList.contains('backspace')) {
                    backspaceTimeout = setTimeout(() => {
                        backspaceInterval = setInterval(() => {
                            output.value = output.value.slice(0, -1);
                        }, 50);
                    }, 500);
                }
            });

            document.addEventListener('mouseup', () => {
                if (backspaceInterval) {
                    clearInterval(backspaceInterval);
                    backspaceInterval = null;
                }
                if (backspaceTimeout) {
                    clearTimeout(backspaceTimeout);
                    backspaceTimeout = null;
                }
            });

            // टच स्क्रिन सपोर्ट
            keyboard.addEventListener('touchstart', (e) => {
                const keyElement = e.target.closest('.key');
                if (keyElement && keyElement.classList.contains('backspace')) {
                    backspaceTimeout = setTimeout(() => {
                        backspaceInterval = setInterval(() => {
                            output.value = output.value.slice(0, -1);
                        }, 50);
                    }, 500);
                }
            });

            document.addEventListener('touchend', () => {
                if (backspaceInterval) {
                    clearInterval(backspaceInterval);
                    backspaceInterval = null;
                }
                if (backspaceTimeout) {
                    clearTimeout(backspaceTimeout);
                    backspaceTimeout = null;
                }
            });

            // कि प्रेस इभेन्ट ह्यान्डलर
            keyboard.addEventListener('click', (e) => {
                const keyElement = e.target.closest('.key');
                if (keyElement) {
                    const key = keyElement.textContent;
                    const isBackspace = keyElement.classList.contains('backspace');

                    if (isBackspace) {
                        output.value = output.value.slice(0, -1);
                    } else {
                        switch(key) {
                            case 'Tab':
                                output.value += '\t';
                                e.preventDefault();
                                break;
                            case 'Caps Lock':
                                capsLock = !capsLock;
                                keyElement.classList.toggle('active-indicator');
                                break;
                            case 'Enter':
                                output.value += '\n';
                                break;
                            case 'Shift':
                                handleShiftClick(keyElement);
                                break;
                            case 'Space':
                                output.value += ' ';
                                break;
                            case 'Ctrl':
                            case 'Alt':
                            case 'Win':
                            case 'Fn':
                                // यी कीहरूको लागि कुनै कार्य छैन
                                break;
                            default:
                                let char = key;
                                if (capsLock || shift) {
                                    char = key.toUpperCase();
                                } else {
                                    char = key.toLowerCase();
                                }
                                if (shift) {
                                    // विशेष क्यारेक्टरहरूको लागि शिफ्ट स्टेट
                                    const shiftMap = {
                                        '1': '!', '2': '@', '3': '#', '4': '$', '5': '%',
                                        '6': '^', '7': '&', '8': '*', '9': '(', '0': ')',
                                        '-': '_', '=': '+', '[': '{', ']': '}', '\\': '|',
                                        ';': ':', "'": '"', ',': '<', '.': '>', '/': '?',
                                        '`': '~'
                                    };
                                    char = shiftMap[key] || char;
                                    if (!shiftLock) {
                                        shift = false;
                                        document.querySelectorAll('.key.shift').forEach(shiftKey => {
                                            shiftKey.classList.remove('active-indicator');
                                        });
                                    }
                                }
                                output.value += char;
                        }
                        
                        // फोकस राख्नुहोस्
                        output.focus();
                    }
                }
            });

            // फिजिकल किबोर्ड इभेन्ट ह्यान्डलर
            document.addEventListener('keydown', (e) => {
                if (e.key === 'CapsLock') {
                    capsLock = !capsLock;
                    document.querySelector('.key.caps').classList.toggle('active-indicator');
                } else if (e.key === 'Shift') {
                    shift = true;
                    document.querySelectorAll('.key.shift').forEach(shiftKey => {
                        shiftKey.classList.add('active-indicator');
                    });
                }
                const key = document.querySelector(`.key[data-key="${e.key}"]`);
                if (key) {
                    key.click();
                    key.classList.add('active');
                }
            });

            document.addEventListener('keyup', (e) => {
                if (e.key === 'Shift') {
                    shift = false;
                    document.querySelectorAll('.key.shift').forEach(shiftKey => {
                        shiftKey.classList.remove('active-indicator');
                    });
                }
                const key = document.querySelector(`.key[data-key="${e.key}"]`);
                if (key) {
                    key.classList.remove('active');
                }
            });

            // Window size detection
            function updateWindowSize() {
                document.getElementById('window-width').textContent = window.innerWidth;
                document.getElementById('window-height').textContent = window.innerHeight;
            }

            // Initial update and event listener
            updateWindowSize();
            window.addEventListener('resize', updateWindowSize);
        });
    </script>
</body>
</html>
